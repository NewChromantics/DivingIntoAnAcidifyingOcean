<!DOCTYPE html>
<html>
<head>
	<link href="https://fonts.googleapis.com/css?family=Karla&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="Web/win95.css" />
	<link rel="stylesheet" type="text/css" href="Web/Hud.css" />
<style>

	body
	{
		font-family:		'Karla', sans-serif;
		font-style:			bold;
		overflow:			hidden;

		background-color:	#000;
		color:				#ccc;	/* text colour */
	}

	#Hud
	{
		pointer-events:	none;
		/*	need a static position to make z index work */
		position:		relative;
		z-index:		50;
	}

	input
	{
		/* always allow pointer events on inputs */
		pointer-events:	auto !important;
	}

</style>
</head>
<body>

	<div id="Hud">
		<div id="AudioMusic">Music: <span id="AudioMusicLabel">Track</span></div>
		<div id="AudioVoice">Voice: <span id="AudioVoiceLabel">Voice</span></div>
		<div id="Subtitle"><span id="SubtitleLabel">Subtitles</span></div>

		<div id="Timeline"><span id="YearStart">1860</span><input type=range id="YearSlider" /><span id="YearEnd">2100</span></div>
		<div id="Year">Year: <span id="YearLabel">000</span></div>

		<div id="Stats">
			<div id="Stats_Temp">Temperature: <span id="Stats_Temp_Label">XXX</span>&deg;C</div>
			<div id="Stats_Co2">CO2 Intake: <span id="Stats_Co2_Label">XXX</span>% More</div>
			<div id="Stats_Oxygen">Oxygen Level: <span id="Stats_Oxygen_Label">-X.XX</span>%</div>
			<div id="Stats_Ph">pH acidity: <span id="Stats_Ph_Label">X</span>% more</div>
		</div>
		
		<div id="TitleText">DIVING INTO AN ACIDIC OCEAN</div>
		<div id="Hint_Start">Start</div><!-- gr: will change this to a button -->
		<div id="Hint_Headphones">Use headphones for a better experience</div>
		<div id="Hint_TapAnimal">TapAnimal</div>
		<div id="Hint_DragTimeline">Drag the timeline to explore</div>
		<div id="AnimalCard"><span id="AnimalCard_Title">Animal</span><span id="AnimalCard_Description">Long description</span></div>

	</div>
	
	<script src='PopEngineCommon/PopWebApi.js'></script>
	<script src='PopEngineCommon/PopWebOpenglApi.js'></script>
	<script src='PopEngineCommon/PopWebGuiApi.js'></script>
	<script src='PopEngineCommon/PopWebImageApi.js'></script>
	<script>
		
		async function Bootup()
		{
			const AsyncAssetLoads = Pop.GetExeArguments().includes('AsyncAssets');
			
			//	preload some assets that we don't load asynchronously
			let AssetPromises = [];
			let Load = async function(Filename)
			{
				//	can either await each one, or accumulate
				if ( AsyncAssetLoads )
				{
					let Promise = Pop.AsyncCacheAssetAsString(Filename);
					AssetPromises.push( Promise );
				}
				else
				{
					await Pop.AsyncCacheAssetAsString(Filename);
				}
			}
			
			//	gr: ideally, if we're async loading all these, we don't await each one...
			//		make it a big array!
			await Load('Timeline.json');
			await Load('CameraSpline.dae.json');
			
			for ( let i=1;	i<=4;	i++ )
			{
				//Load('Ocean/ocean_pts.' + (''+i).padStart(4,'0') + '.ply');
			}
			for ( let i=1;	i<=10;	i++ )
			{
				await Load('Ocean/ocean_pts.' + (''+i).padStart(4,'0') + '.ply.mesh.json');
			}
			
			await Load('Shell/shellFromBlender.obj');
			await Load('Quad.vert.glsl');
			await Load('ParticleTriangles.vert.glsl');
			await Load('ParticleColour.frag.glsl');
			await Load('BlitCopy.frag.glsl');
			await Load('Geo.vert.glsl');
			await Load('Colour.frag.glsl');
			await Load('Edge.frag.glsl');
			await Load('PhysicsIteration_UpdateVelocity.frag.glsl');
			await Load('PhysicsIteration_UpdatePosition.frag.glsl');

			await Load('AssetManager.js');
			await Load('AudioManager.js');
			await Load('Hud.js');
			await Load('PopEngineCommon/PopShaderCache.js');
			await Load('PopEngineCommon/PopFrameCounter.js');
			await Load('PopEngineCommon/PopCamera.js');
			await Load('PopEngineCommon/PopMath.js');
			await Load('PopEngineCommon/ParamsWindow.js');
			await Load('PopEngineCommon/PopPly.js');
			await Load('PopEngineCommon/PopObj.js');
			await Load('PopEngineCommon/PopCollada.js');
			await Load('PopEngineCommon/PopTexture.js');
			await Load('Noise0.png');

			console.log("AssetPromises:",AssetPromises);
			await Promise.all( AssetPromises );
			let Source = await Pop.LoadFileAsStringAsync('bootup.js');
			Pop.CompileAndRun( Source, 'bootup.js' );
		}

		Bootup().then( e=>Pop.Debug("Finished!",e) ).catch( console.error );
	
	</script>
	
</body>

